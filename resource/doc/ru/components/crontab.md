# workerman/crontab

# Описание
`workerman/crontab` - это программа для выполнения задач по расписанию на основе workerman, аналогичная crontab в Linux. `workerman/crontab` поддерживает выполнение задач с точностью до секунды.

> Для использования `workerman/crontab` необходимо предварительно установить часовой пояс в PHP, иначе результат выполнения может не совпадать с ожидаемым.

## Описание времени
```
0   1   2   3   4   5
|   |   |   |   |   |
|   |   |   |   |   +------ день недели (0 - 6) (воскресенье=0)
|   |   |   |   +------ месяц (1 - 12)
|   |   |   +-------- число месяца (1 - 31)
|   |   +---------- час (0 - 23)
|   +------------ минута (0 - 59)
+-------------- секунда (0-59) [может быть опущено, если отсутствует 0, то минимальным интервалом будет минута]
```

# Установка
```
composer require workerman/crontab
```

# Пример
```php
<?php
use Workerman\Worker;
require __DIR__ . '/vendor/autoload.php';

use Workerman\Crontab\Crontab;
$worker = new Worker();

// Установка часового пояса, чтобы избежать расхождения результата выполнения с ожидаемым
date_default_timezone_set('PRC');

$worker->onWorkerStart = function () {
    // Выполнять каждую минуту в первую секунду.
    new Crontab('1 * * * * *', function(){
        echo date('Y-m-d H:i:s')."\n";
    });
    // Выполнять в 7 часов 50 минут каждый день, обратите внимание, что здесь опущен секундный интервал.
    new Crontab('50 7 * * *', function(){
        echo date('Y-m-d H:i:s')."\n";
    });
};

Worker::runAll();
```

> Примечание: Задачи по расписанию не выполняются немедленно, все задачи по расписанию начинают отсчет времени только в следующую минуту.

# API
**Crontab::destroy()**

Уничтожить таймер
```
$crontab = new Crontab('1 * * * * *', function(){
    echo date('Y-m-d H:i:s')."\n";
});
$crontab->destroy();
```
