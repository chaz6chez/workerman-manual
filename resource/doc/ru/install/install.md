# Инструкция по установке
WorkerMan фактически представляет собой пакет PHP-кода. Если у вас уже установлена среда PHP, вам нужно просто загрузить исходный код WorkerMan или демонстрационные примеры для запуска.

**Установка через Composer:**
```sh
composer require workerman/workerman
```

> **Примечание**
> Некоторые зеркала Composer не полны. Чтобы использовать вышеуказанную команду, выполните `composer config -g --unset repos.packagist`, чтобы удалить зеркало.

# Пользователи Windows (обязательно прочтите)

С версии workerman 3.5.3 workerman поддерживает как систему Windows, так и Linux.
Пользователям Windows необходимо настроить переменные среды PHP.

` === Ниже на этой странице применимо только для среды Linux workerman, пользователи Windows могут игнорировать === `

# Проверка среды Linux
Система Linux может использовать следующий скрипт для проверки соответствия локальной среды PHP требованиям WorkerMan.
 `curl -Ss https://www.workerman.net/check | php`

Если в выводе этого скрипта отображается "ok", это означает, что выполняются требования WorkerMan, и можно просто загрузить примеры с [официального сайта](https://www.workerman.net/) и запустить их.

Если не все проверки проходят успешно, следуйте документу ниже для установки недостающих расширений.

(Примечание: скрипт проверки не проверяет расширение event. Если количество одновременных соединений в приложении превышает 1024, необходимо установить расширение event и выполнить [оптимизацию ядра Linux](../appendices/kernel-optimization.md). Методы установки расширения описаны ниже.)

# Установка недостающих расширений для существующей среды PHP

## Установка расширений pcntl и posix:

**Система CentOS**
Если PHP установлен с помощью yum, выполните в командной строке следующую команду: `yum install php-process`, чтобы установить расширения pcntl и posix.

Если установка не удалась или PHP был установлен иным способом, обратитесь к разделу "Установка расширений" в [Приложениях](../appendices/install-extension.md) для инструкций по установке из исходного кода.

**Системы Debian/Ubuntu/Mac OS**
Следуйте инструкциям в разделе "Установка расширений" в [Приложениях](../appendices/install-extension.md) для инструкций по установке из исходного кода.

## Установка расширения event:
Чтобы поддерживать большее количество одновременных соединений, необходимо установить расширение event и выполнить [оптимизацию ядра Linux](../appendices/kernel-optimization.md). Для установки выполните следующие шаги:

**Система CentOS**

1. Установите пакет libevent-devel, требуемый для установки расширения event, выполните в командной строке:
   ```shell
   yum install libevent-devel -y
   # Если установка невозможна, попробуйте выполнить следующую команду:
   # yum install libevent2-devel -y
   ```

2. Установите расширение event, выполните в командной строке (расширение event требует PHP>=5.4):
   ```shell
   pecl install event
   ```
   Обратите внимание на запрос: `Include libevent OpenSSL support [yes] :`. Введите `no` и нажмите Enter, остальные запросы можно пропустить.

3. Запустите команду `php --ini`, найдите и откройте файл php.ini, и вставьте следующую конфигурацию в конец файла:
   ```shell
   extension=event.so
   ```

**Системы Debian/Ubuntu**

1. Установите пакет libevent-dev, требуемый для установки расширения event, выполните в командной строке:
   ```shell
   apt-get install libevent-dev -y
   # Если установка не удалась, попробуйте выполнить следующую команду:
   # apt-get install libevent2-dev -y
   ```

2. Установите расширение event, выполните в командной строке:
   ```shell
   pecl install event
   ```
   Обратите внимание на запрос: `Include libevent OpenSSL support [yes] :`. Введите `no` и нажмите Enter, остальные запросы можно пропустить.

3. Запустите команду `php --ini`, найдите и откройте файл php.ini, и вставьте следующую конфигурацию в конец файла:
   ```shell
   extension=event.so
   ```

**Инструкция по установке на системе Mac OS**

Mac OS обычно используется в качестве разработочной платформы и расширение event не требуется.

# Установка на новой системе (установка PHP + расширения)
## Инструкция по установке на системе CentOS

1. В командной строке выполните следующую команду (также установите основную программу PHP, pcntl, posix, библиотеку libevent и программу git):
   ```shell
   yum install php-cli php-process git gcc php-devel php-pear libevent-devel -y
   ```

2. Установите расширение event, выполните в командной строке (расширение event требует PHP>=5.4):
   ```shell
   pecl install event
   ```
   Обратите внимание на запрос: `Include libevent OpenSSL support [yes] :`. Введите `no` и нажмите Enter, остальные запросы можно пропустить.
   
3. Запустите команду `php --ini`, найдите и откройте файл php.ini, и вставьте следующую конфигурацию в конец файла:
   ```shell
   extension=event.so
   ```

4. В командной строке выполните следующую команду (это загрузит основную программу WorkerMan из GitHub):
   ```shell
   git clone https://github.com/walkor/Workerman
   ```

5. Следуйте инструкциям в разделе "Простой пример разработки" в [Руководстве по началу работы](../getting-started/simple-example.md) для создания входного файла и запуска его.
   Или загрузите готовый пример с [официального сайта](https://www.workerman.net/) и запустите его.

## Инструкция по установке на системе Debian/Ubuntu

1. В командной строке выполните следующую команду (также установите основную программу PHP, libevent и программу git):
   ```shell
   apt-get install php-cli git gcc php-pear php-dev libevent-dev -y
   ```

2. Установите расширение event, выполните в командной строке (расширение event требует PHP>=5.4):
   ```shell
   pecl install event
   ```
   Обратите внимание на запрос: `Include libevent OpenSSL support [yes] :`. Введите `no` и нажмите Enter, остальные запросы можно пропустить.
   
3. Запустите команду `php --ini`, найдите и откройте файл php.ini, и вставьте следующую конфигурацию в конец файла:
   ```shell
   extension=event.so
   ```

4. В командной строке выполните следующую команду (это загрузит основную программу WorkerMan из GitHub):
   ```shell
   git clone https://github.com/walkor/Workerman
   ```

5. Следуйте инструкциям в разделе "Простой пример разработки" в [Руководстве по началу работы](../getting-started/simple-example.md) для создания входного файла и запуска его.
   Или загрузите готовый пример с [официального сайта](https://www.workerman.net/) и запустите его.

## Инструкция по установке на системе Mac OS

**Метод 1:** Mac OS уже поставляется с PHP CLI, но возможно недостает расширения `pcntl`.

1. Следуйте инструкциям в разделе "Установка расширения" в [Приложениях](../appendices/install-extension.md) для установки расширения `pcntl`.

2. Следуйте инструкциям в разделе "Установка расширения" в [Приложениях](../appendices/install-extension.md) для установки расширения `event` (для рабочих станций этот шаг можно опустить).

3. Загрузите основную программу WorkerMan по адресу https://www.workerman.net/download/workermanzip, или загрузите пример с [официального сайта](https://www.workerman.net/) и запустите его.

**Метод 2:** Установка PHP с соответствующими расширениями с помощью команды `brew`

1. В командной строке выполните следующую команду для установки утилиты `brew` (если у вас уже установлен `brew`, этот шаг можно пропустить):
   ```shell
   /usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
   ```

2. В командной строке выполните следующую команду для установки `php`:
   ```shell
   brew install php
   ```

3. В командной строке выполните следующую команду для установки расширения `event`:
   ```shell
   brew install php-event    
   ```

4. Загрузите пример с [официального сайта](https://www.workerman.net/) и запустите его.

# Объяснение о расширении Event
[Расширение Event](https://php.net/manual/zh/book.event.php) не обязательно, но если для бизнеса необходима поддержка более 1000 одновременных соединений, рекомендуется установить Event, так как оно позволяет поддерживать огромное количество одновременных соединений. Если бизнесу требуется менее 1000 одновременных соединений, например, менее 1000 одновременных соединений, то установка не требуется.

## Часто задаваемые вопросы
1. Если возникает ошибка `checking for include/event2/event.h... not found`, попробуйте сначала удалить пакет libevent-devel и установить libevent2-devel:
   Для системы CentOS: `yum remove libevent-devel && yum install libevent2-devel`
   Для систем Debian / Ubuntu: `apt-get remove libevent-dev && apt-get install libevent2-dev`

2. Если возникает ошибка `NOTICE: PHP message: PHP Warning: PHP Startup: Unable to load dynamic library '.../event.so' - ..../event.so: undefined symbol: php_sockets_le_socket in Unknown on line 0`, измените порядок загрузки event.so и socket.so, то есть добавьте `extension=socket.so` перед `extension=event.so` в файле php.ini, чтобы сначала загрузилось расширение socket.
